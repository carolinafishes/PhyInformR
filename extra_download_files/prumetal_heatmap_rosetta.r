
##set your wd to match where the below files are
setwd("~/Dropbox/avian-phylogenomics/Zenodo/Phylogenetic_Informativeness")


###Next read in all the rate vector files 
source("~/Dropbox/avian-phylogenomics/Zenodo/Phylogenetic_Informativeness/loci1_30Allrates_file.allrates")
source("~/Dropbox/avian-phylogenomics/Zenodo/Phylogenetic_Informativeness/loci31_62Allrates_file.allrates")
source("~/Dropbox/avian-phylogenomics/Zenodo/Phylogenetic_Informativeness/loci63_100Allrates_file.allrates")
source("~/Dropbox/avian-phylogenomics/Zenodo/Phylogenetic_Informativeness/loci101_141Allrates_file.allrates")
source("~/Dropbox/avian-phylogenomics/Zenodo/Phylogenetic_Informativeness/loci142_197Allrates_file.allrates")
source("~/Dropbox/avian-phylogenomics/Zenodo/Phylogenetic_Informativeness/loci200_240Allrates_file.allrates")
source("~/Dropbox/avian-phylogenomics/Zenodo/Phylogenetic_Informativeness/242_280Allrates_file.allrates")
source("~/Dropbox/avian-phylogenomics/Zenodo/Phylogenetic_Informativeness/281_314Allrates_file.allrates")
source("~/Dropbox/avian-phylogenomics/Zenodo/Phylogenetic_Informativeness/314_349Allrates_file.allrates")

##note on the above, we encountered memory limitations getting all the individual rate vectors, so we broke the dataset into stages to save memory. With a better machine you could just estimates all the site rates at once. 


##here we are generating PI profiles
L1<-ratesA[1:1594]
L2<-ratesA[1595:3354]
L3<-ratesA[3355:4990]
L4<-ratesA[4991:6483]
L5<-ratesA[6484:8117]
L6<-ratesA[8118:9799]
L7<-ratesA[9800:10831]
L8<-ratesA[10832:12320]
L9<-ratesA[12321:14008]
L10<-ratesA[14009:15201]
L11<-ratesA[15202:16983]
L12<-ratesA[16984:18640]
L21<-ratesA[18641:19530]
L22<-ratesA[19531:21236]
L24<-ratesA[21237:22925]
L27<-ratesA[22926:23933]
L28<-ratesA[23934:25539]
L30<-ratesA[25540:27222]
L31<-ratesB[1:1743]
L32<-ratesB[1744:3155]
L34<-ratesB[3156:4772]
L35<-ratesB[4773:6490]
L36<-ratesB[6491:7839]
L37<-ratesB[7840:9461]
L38<-ratesB[9462:11134]
L39<-ratesB[11135:12773]
L41<-ratesB[12774:14451]
L42<-ratesB[14452:15980]
L43<-ratesB[15981:17635]
L44<-ratesB[17636:19274]
L48<-ratesB[19275:20892]
L49<-ratesB[20893:22501]
L50<-ratesB[22502:24067]
L51<-ratesB[24068:24676]
L53<-ratesB[24677:26336]
L54<-ratesB[26337:27837]
L57<-ratesB[27838:28703]
L58<-ratesB[28704:30437]
L59<-ratesB[30438:32254]
L61<-ratesB[32255:33594]
L62<-ratesB[33595:35320]
L63<-ratesC[1:1639] 
L64<-ratesC[1640:3343] 
L65<-ratesC[3344:4969] 
L67<-ratesC[4970:6692] 
L72<-ratesC[6693:8126] 
L73<-ratesC[8127:9466] 
L74<-ratesC[9467:10561] 
L75<-ratesC[10562:12104] 
L76<-ratesC[12105:13564] 
L77<-ratesC[13565:14900] 
L78<-ratesC[14901:16176] 
L79<-ratesC[16177:17743] 
L80<-ratesC[17744:19041] 
L81<-ratesC[19042:20639] 
L82<-ratesC[20640:22331] 
L85<-ratesC[22332:24059] 
L86<-ratesC[24060:25809] 
L87<-ratesC[25810:27611] 
L88<-ratesC[27612:29278] 
L89<-ratesC[29279:30703] 
L91<-ratesC[30704:32444] 
L94<-ratesC[32445:33290] 
L95<-ratesC[33291:34744] 
L98<-ratesC[34745:36509] 
L99<-ratesC[36510:38221] 
L100<-ratesC[38222:39639]
L102<-ratesD[1:1351] 
L103<-ratesD[1352:3040] 
L104<-ratesD[3041:4772]
L105<-ratesD[4773:6235] 
L107<-ratesD[6236:7937] 
L108<-ratesD[7938:9637] 
L110<-ratesD[9638:11009] 
L111<-ratesD[11010:12347] 
L113<-ratesD[12348:14304] 
L115<-ratesD[14305:15037] 
L116<-ratesD[15038:16416] 
L118<-ratesD[16417:17430] 
L119<-ratesD[17431:19016] 
L120<-ratesD[19017:20594] 
L121<-ratesD[20595:22531] 
L122<-ratesD[22532:24477] 
L125<-ratesD[24478:26123] 
L126<-ratesD[26124:27793] 
L127<-ratesD[27794:29519] 
L128<-ratesD[29520:30838] 
L129<-ratesD[30839:32483] 
L130<-ratesD[32484:34253] 
L131<-ratesD[34254:35386] 
L133<-ratesD[35387:36951] 
L134<-ratesD[36952:38522] 
L135<-ratesD[38523:40150] 
L136<-ratesD[40151:42208] 
L137<-ratesD[42209:43745] 
L141<-ratesD[43746:44950]
L142<-ratesE[1:1728] 
L143<-ratesE[1729:3316] 
L145<-ratesE[3317:5021] 
L146<-ratesE[5022:6809] 
L147<-ratesE[6810:8445] 
L148<-ratesE[8446:9774] 
L149<-ratesE[9775:11581] 
L150<-ratesE[11582:13436] 
L151<-ratesE[13437:15147] 
L152<-ratesE[15148:16584] 
L153<-ratesE[16585:18687] 
L154<-ratesE[18688:20374] 
L155<-ratesE[20375:22047] 
L157<-ratesE[22048:23581] 
L158<-ratesE[23582:25368] 
L159<-ratesE[25369:26648] 
L161<-ratesE[26649:28612] 
L162<-ratesE[28613:30146] 
L163<-ratesE[30147:31220] 
L165<-ratesE[31221:32704] 
L169<-ratesE[32705:34487] 
L170<-ratesE[34488:36262] 
L171<-ratesE[36263:38252] 
L174<-ratesE[38253:39153] 
L175<-ratesE[39154:40882] 
L176<-ratesE[40883:42794] 
L177<-ratesE[42795:44516] 
L178<-ratesE[44517:46226] 
L180<-ratesE[46227:47912] 
L181<-ratesE[47913:49716] 
L182<-ratesE[49717:51708] 
L183<-ratesE[51709:53072] 
L184<-ratesE[53073:54660] 
L186<-ratesE[54661:56124] 
L187<-ratesE[56125:57793] 
L188<-ratesE[57794:59329] 
L189<-ratesE[59330:61222] 
L190<-ratesE[61223:62883] 
L192<-ratesE[62884:64243] 
L193<-ratesE[64244:64715] 
L194<-ratesE[64716:66490] 
L195<-ratesE[66491:68210] 
L196<-ratesE[68211:69909] 
L197<-ratesE[69910:71170]
L201<-ratesF[1:1060] 
L202<-ratesF[1061:2758] 
L203<-ratesF[2759:4671] 
L204<-ratesF[4672:6700] 
L205<-ratesF[6701:8387] 
L206<-ratesF[8388:9997] 
L207<-ratesF[9998:11414] 
L208<-ratesF[11415:11864] 
L209<-ratesF[11865:12949] 
L210<-ratesF[12950:14353] 
L211<-ratesF[14354:16035] 
L213<-ratesF[16036:18351] 
L214<-ratesF[18352:19979] 
L215<-ratesF[19980:21151] 
L216<-ratesF[21152:22828] 
L217<-ratesF[22829:23765] 
L219<-ratesF[23766:24489] 
L221<-ratesF[24490:26260] 
L222<-ratesF[26261:27927] 
L223<-ratesF[27928:28371] 
L224<-ratesF[28372:29642] 
L225<-ratesF[29643:30613] 
L226<-ratesF[30614:32428] 
L228<-ratesF[32429:34260] 
L229<-ratesF[34261:35864] 
L230<-ratesF[35865:37529] 
L231<-ratesF[37530:39039] 
L232<-ratesF[39040:40783] 
L233<-ratesF[40784:41629] 
L234<-ratesF[41630:43314] 
L235<-ratesF[43315:45010] 
L237<-ratesF[45011:45831] 
L239<-ratesF[45832:46680] 
L240<-ratesF[46681:48146]
L241<-ratesG[1:1737] 
L242<-ratesG[1738:3137] 
L243<-ratesG[3138:4101] 
L244<-ratesG[4102:5203] 
L245<-ratesG[5204:6982] 
L246<-ratesG[6983:8699] 
L247<-ratesG[8700:10305] 
L248<-ratesG[10306:11853] 
L249<-ratesG[11854:12840] 
L250<-ratesG[12841:14367] 
L251<-ratesG[14368:16098] 
L252<-ratesG[16099:17753] 
L253<-ratesG[17754:19097] 
L255<-ratesG[19098:20790] 
L256<-ratesG[20791:22514] 
L257<-ratesG[22515:24232] 
L258<-ratesG[24233:26099] 
L260<-ratesG[26100:27700] 
L261<-ratesG[27701:29447] 
L262<-ratesG[29448:31029] 
L264<-ratesG[31030:32822] 
L265<-ratesG[32823:33361] 
L266<-ratesG[33362:35547] 
L267<-ratesG[35548:37206] 
L269<-ratesG[37207:38604] 
L270<-ratesG[38605:40123] 
L271<-ratesG[40124:41740] 
L272<-ratesG[41741:42304] 
L275<-ratesG[42305:43515] 
L276<-ratesG[43516:45199] 
L277<-ratesG[45200:46347] 
L279<-ratesG[46348:47213] 
L280<-ratesG[47214:48742]
L281<-ratesH[1:1726] 
L282<-ratesH[1727:3670] 
L288<-ratesH[3671:5341] 
L289<-ratesH[5342:7002] 
L290<-ratesH[7003:8661] 
L292<-ratesH[8662:10362] 
L293<-ratesH[10363:12103] 
L294<-ratesH[12104:13576] 
L295<-ratesH[13577:15304] 
L296<-ratesH[15305:16994] 
L297<-ratesH[16995:18550] 
L298<-ratesH[18551:20402] 
L301<-ratesH[20403:21124] 
L302<-ratesH[21125:21990] 
L303<-ratesH[21991:23590] 
L305<-ratesH[23591:24342] 
L306<-ratesH[24343:26134] 
L307<-ratesH[26135:27276] 
L310<-ratesH[27277:28956] 
L311<-ratesH[28957:30731] 
L312<-ratesH[30732:32141] 
L314<-ratesH[32142:33859]
L315<-ratesI[1:1720] 
L316<-ratesI[1721:3516]
L317<-ratesI[3517:4945]
L318<-ratesI[4946:6375] 
L319<-ratesI[6376:7991] 
L320<-ratesI[7992:9624] 
L321<-ratesI[9625:11381] 
L322<-ratesI[11382:13087] 
L325<-ratesI[13088:14812] 
L327<-ratesI[14813:16353] 
L328<-ratesI[16354:18028] 
L329<-ratesI[18029:19779] 
L330<-ratesI[19780:21420] 
L331<-ratesI[21421:22620] 
L333<-ratesI[22621:24319] 
L334<-ratesI[24320:25487] 
L335<-ratesI[25488:27171] 
L336<-ratesI[27172:28622] 
L337<-ratesI[28623:30241] 
L338<-ratesI[30242:32164] 
L339<-ratesI[32165:33465] 
L340<-ratesI[33466:35125] 
L341<-ratesI[35126:36853] 
L342<-ratesI[36854:38590] 
L343<-ratesI[38591:39982] 
L344<-ratesI[39983:40942] 
L346<-ratesI[40943:42519] 
L347<-ratesI[42520:44188] 
L348<-ratesI[44189:45275] 
L349<-ratesI[45276:45636]

##signal noise functions require matrix formatted site rates, so convert first
as.matrix(L1)->L1
as.matrix(L2)->L2
as.matrix(L3)->L3
as.matrix(L4)->L4
as.matrix(L5)->L5
as.matrix(L6)->L6
as.matrix(L7)->L7
as.matrix(L8)->L8
as.matrix(L9)->L9
as.matrix(L10)->L10
as.matrix(L11)->L11
as.matrix(L12)->L12
as.matrix(L21)->L21
as.matrix(L22)->L22
as.matrix(L24)->L24
as.matrix(L27)->L27
as.matrix(L28)->L28
as.matrix(L30)->L30
as.matrix(L31)->L31
as.matrix(L32)->L32
as.matrix(L34)->L34
as.matrix(L35)->L35
as.matrix(L36)->L36
as.matrix(L37)->L37
as.matrix(L38)->L38
as.matrix(L39)->L39
as.matrix(L41)->L41
as.matrix(L42)->L42
as.matrix(L43)->L43
as.matrix(L44)->L44
as.matrix(L48)->L48
as.matrix(L49)->L49
as.matrix(L50)->L50
as.matrix(L51)->L51
as.matrix(L53)->L53
as.matrix(L54)->L54
as.matrix(L57)->L57
as.matrix(L58)->L58
as.matrix(L59)->L59
as.matrix(L61)->L61
as.matrix(L62)->L62
as.matrix(L63)->L63
as.matrix(L64)->L64
as.matrix(L65)->L65
as.matrix(L67)->L67
as.matrix(L72)->L72
as.matrix(L73)->L73
as.matrix(L74)->L74
as.matrix(L75)->L75
as.matrix(L76)->L76
as.matrix(L77)->L77
as.matrix(L78)->L78
as.matrix(L79)->L79
as.matrix(L80)->L80
as.matrix(L81)->L81
as.matrix(L82)->L82
as.matrix(L85)->L85
as.matrix(L86)->L86
as.matrix(L87)->L87
as.matrix(L88)->L88
as.matrix(L89)->L89
as.matrix(L91)->L91
as.matrix(L94)->L94
as.matrix(L95)->L95
as.matrix(L98)->L98
as.matrix(L99)->L99
as.matrix(L100)->L100
as.matrix(L102)->L102
as.matrix(L103)->L103
as.matrix(L104)->L104
as.matrix(L105)->L105
as.matrix(L107)->L107
as.matrix(L108)->L108
as.matrix(L110)->L110
as.matrix(L111)->L111
as.matrix(L113)->L113
as.matrix(L115)->L115
as.matrix(L116)->L116
as.matrix(L118)->L118
as.matrix(L119)->L119
as.matrix(L120)->L120
as.matrix(L121)->L121
as.matrix(L122)->L122
as.matrix(L125)->L125
as.matrix(L126)->L126
as.matrix(L127)->L127
as.matrix(L128)->L128
as.matrix(L129)->L129
as.matrix(L130)->L130
as.matrix(L131)->L131
as.matrix(L133)->L133
as.matrix(L134)->L134
as.matrix(L135)->L135
as.matrix(L136)->L136
as.matrix(L137)->L137
as.matrix(L141)->L141
as.matrix(L142)->L142
as.matrix(L143)->L143
as.matrix(L145)->L145
as.matrix(L146)->L146
as.matrix(L147)->L147
as.matrix(L148)->L148
as.matrix(L149)->L149
as.matrix(L150)->L150
as.matrix(L151)->L151
as.matrix(L152)->L152
as.matrix(L153)->L153
as.matrix(L154)->L154
as.matrix(L155)->L155
as.matrix(L157)->L157
as.matrix(L158)->L158
as.matrix(L159)->L159
as.matrix(L161)->L161
as.matrix(L162)->L162
as.matrix(L163)->L163
as.matrix(L165)->L165
as.matrix(L169)->L169
as.matrix(L170)->L170
as.matrix(L171)->L171
as.matrix(L174)->L174
as.matrix(L175)->L175
as.matrix(L176)->L176
as.matrix(L177)->L177
as.matrix(L178)->L178
as.matrix(L180)->L180
as.matrix(L181)->L181
as.matrix(L182)->L182
as.matrix(L183)->L183
as.matrix(L184)->L184
as.matrix(L186)->L186
as.matrix(L187)->L187
as.matrix(L188)->L188
as.matrix(L189)->L189
as.matrix(L190)->L190
as.matrix(L192)->L192
as.matrix(L193)->L193
as.matrix(L194)->L194
as.matrix(L195)->L195
as.matrix(L196)->L196
as.matrix(L197)->L197
as.matrix(L201)->L201
as.matrix(L202)->L202
as.matrix(L203)->L203
as.matrix(L204)->L204
as.matrix(L205)->L205
as.matrix(L206)->L206
as.matrix(L207)->L207
as.matrix(L208)->L208
as.matrix(L209)->L209
as.matrix(L210)->L210
as.matrix(L211)->L211
as.matrix(L213)->L213
as.matrix(L214)->L214
as.matrix(L215)->L215
as.matrix(L216)->L216
as.matrix(L217)->L217
as.matrix(L219)->L219
as.matrix(L221)->L221
as.matrix(L222)->L222
as.matrix(L223)->L223
as.matrix(L224)->L224
as.matrix(L225)->L225
as.matrix(L226)->L226
as.matrix(L228)->L228
as.matrix(L229)->L229
as.matrix(L230)->L230
as.matrix(L231)->L231
as.matrix(L232)->L232
as.matrix(L233)->L233
as.matrix(L234)->L234
as.matrix(L235)->L235
as.matrix(L237)->L237
as.matrix(L239)->L239
as.matrix(L240)->L240
as.matrix(L241)->L241
as.matrix(L242)->L242
as.matrix(L243)->L243
as.matrix(L244)->L244
as.matrix(L245)->L245
as.matrix(L246)->L246
as.matrix(L247)->L247
as.matrix(L248)->L248
as.matrix(L249)->L249
as.matrix(L250)->L250
as.matrix(L251)->L251
as.matrix(L252)->L252
as.matrix(L253)->L253
as.matrix(L255)->L255
as.matrix(L256)->L256
as.matrix(L257)->L257
as.matrix(L258)->L258
as.matrix(L260)->L260
as.matrix(L261)->L261
as.matrix(L262)->L262
as.matrix(L264)->L264
as.matrix(L265)->L265
as.matrix(L266)->L266
as.matrix(L267)->L267
as.matrix(L269)->L269
as.matrix(L270)->L270
as.matrix(L271)->L271
as.matrix(L272)->L272
as.matrix(L275)->L275
as.matrix(L276)->L276
as.matrix(L277)->L277
as.matrix(L279)->L279
as.matrix(L280)->L280
as.matrix(L281)->L281
as.matrix(L282)->L282
as.matrix(L288)->L288
as.matrix(L289)->L289
as.matrix(L290)->L290
as.matrix(L292)->L292
as.matrix(L293)->L293
as.matrix(L294)->L294
as.matrix(L295)->L295
as.matrix(L296)->L296
as.matrix(L297)->L297
as.matrix(L298)->L298
as.matrix(L301)->L301
as.matrix(L302)->L302
as.matrix(L303)->L303
as.matrix(L305)->L305
as.matrix(L306)->L306
as.matrix(L307)->L307
as.matrix(L310)->L310
as.matrix(L311)->L311
as.matrix(L312)->L312
as.matrix(L314)->L314
as.matrix(L315)->L315
as.matrix(L316)->L316
as.matrix(L317)->L317
as.matrix(L318)->L318
as.matrix(L319)->L319
as.matrix(L320)->L320
as.matrix(L321)->L321
as.matrix(L322)->L322
as.matrix(L325)->L325
as.matrix(L327)->L327
as.matrix(L328)->L328
as.matrix(L329)->L329
as.matrix(L330)->L330
as.matrix(L331)->L331
as.matrix(L333)->L333
as.matrix(L334)->L334
as.matrix(L335)->L335
as.matrix(L336)->L336
as.matrix(L337)->L337
as.matrix(L338)->L338
as.matrix(L339)->L339
as.matrix(L340)->L340
as.matrix(L341)->L341
as.matrix(L342)->L342
as.matrix(L343)->L343
as.matrix(L344)->L344
as.matrix(L346)->L346
as.matrix(L347)->L347
as.matrix(L348)->L348
as.matrix(L349)->L349

allrates<- c(L1,L2,L3,L4,L5,L6,L7,L8,L9,L10,L11,L12,L21,L22,L24,L27,L28,L30,L31,L32,L34,L35,L3 6,L37,L38,L39,L41,L42,L43,L44,L48,L49,L50,L51,L53,L54,L57,L58,L59,L61,L62,L63,L64,L 65,L67,L72,L73,L74,L75,L76,L77,L78,L79,L80,L81,L82,L85,L86,L87,L88,L89,L91,L94,L95, L98,L99,L100,L102,L103,L104,L105,L107,L108,L110,L111,L113,L115,L116,L118,L119,L12 0,L121,L122,L125,L126,L127,L128,L129,L130,L131,L133,L134,L135,L136,L137,L141,L142, L143,L145,L146,L147,L148,L149,L150,L151,L152,L153,L154,L155,L157,L158,L159,L161,L 162,L163,L165,L169,L170,L171,L174,L175,L176,L177,L178,L180,L181,L182,L183,L184,L1 86,L187,L188,L189,L190,L192,L193,L194,L195,L196,L197,L201,L202,L203,L204,L205,L209,L207,L208,L209,L210,L211,L213,L214,L215,L216,L217,L219,L221,L222,L223,L224,L225, L226,L228,L229,L230,L231,L232,L233,L234,L235,L237,L239,L240,L241,L242,L243,L244,L 245,L246,L247,L248,L249,L250,L251,L252,L253,L255,L256,L257,L258,L260,L261,L262,L2 64,L265,L266,L267,L269,L270,L271,L272,L275,L276,L277,L279,L280,L281,L282,L288,L28 9,L290,L292,L293,L294,L295,L296,L297,L298,L301,L302,L303,L305,L306,L307,L310,L311, L312,L314,L315,L316,L317,L318,L319,L320,L321,L322,L325,L327,L328,L329,L330,L331,L 333,L334,L335,L336,L337,L338,L339,L340,L341,L342,L343,L344,L346,L347,L348,L349)

as.matrix(allrates)->allrates